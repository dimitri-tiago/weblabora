<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts-config PUBLIC 
"-//Apache Software Foundation//DTD Struts Configuration 1.3//EN" 
"http://jakarta.apache.org/struts/dtds/struts-config_1_3.dtd">
<struts-config>

	<form-beans>
		<form-bean name="nullForm" type="com.philihp.weblabora.form.NullForm" />
		<form-bean name="loginForm" type="com.philihp.weblabora.form.LoginForm" />
		<form-bean name="hijackForm" type="com.philihp.weblabora.form.HijackForm" />
		<form-bean name="gameForm" type="com.philihp.weblabora.form.GameForm" />
		<form-bean name="joinGameForm" type="com.philihp.weblabora.form.JoinGameForm" />
		<form-bean name="moveForm"  type="com.philihp.weblabora.form.MoveForm" />
		<form-bean name="createGameForm" type="com.philihp.weblabora.form.CreateGameForm" />
		<form-bean name="registerForm" type="com.philihp.weblabora.form.RegisterForm"/>
		<form-bean name="forgotPasswordForm" type="com.philihp.weblabora.form.ForgotPasswordForm" />
		<form-bean name="accountForm" type="com.philihp.weblabora.form.AccountForm" />
		<form-bean name="resetPasswordForm" type="com.philihp.weblabora.form.ResetPasswordForm" />
		<form-bean name="resetAccountPasswordForm" type="com.philihp.weblabora.form.ResetAccountPasswordForm" />
		<form-bean name="createChatForm" type="com.philihp.weblabora.form.CreateChatForm" />
	</form-beans>

	<global-exceptions>
		<!--exception type="com.philihp.weblabora.action.AuthenticationException" path="/login.do" key="" /-->
		<exception type="java.net.UnknownHostException" path="/error.jsp" key="exception.unknownHost" />
		<exception type="com.philihp.weblabora.util.AuthenticationException" path="/login.do" key="errors.notLoggedIn" />
	</global-exceptions>

	<global-forwards>
		<forward name="authenticate" path="/authenticate.do" redirect="true" />
		<forward name="root" redirect="true" path="/" />

		<!-- only index.jsp should use this, but it must be global -->
		<forward name="lobby" redirect="true" path="/showLobby.do" />
		<forward name="show-game" redirect="true" path="/showGame.do" />
	</global-forwards>

	<action-mappings>
		<action path="/authenticateHijack" name="hijackForm" type="com.philihp.weblabora.action.AuthenticateHijack" />
		<action path="/offline" type="com.philihp.weblabora.action.Offline" />
		<action path="/login"
				name="loginForm"
				scope="session"
				validate="false"
				type="com.philihp.weblabora.action.Login" parameter="/login.jsp" />
		<action path="/loginSubmit"
				name="loginForm"
				scope="session"
				input="/login.jsp"
				validate="true"
				type="com.philihp.weblabora.action.LoginSubmit">
			<forward name="input" path="/login.jsp" />
		</action>
		<action path="/logout" name="loginForm" validate="false" scope="session" type="com.philihp.weblabora.action.Logout" />
		<action path="/register"
		        name="registerForm"
		        scope="session"
		        validate="false"
		        type="com.philihp.weblabora.action.Register" parameter="/register.jsp" />
		<action path="/registerSubmit"
				name="registerForm"
				scope="session"
				input="/register.jsp"
				validate="true"
				type="com.philihp.weblabora.action.RegisterSubmit"
				>
			<forward name="input" path="/register.jsp" />
		</action>
		<action path="/authenticate" type="org.apache.struts.actions.ForwardAction" parameter="/loginFacebook.do" />
		<action path="/loginFacebook"
				name="registerForm"
				scope="session"
				validate="false"
				type="com.philihp.weblabora.action.LoginFacebook">
			<forward name="register" path="/register.do" />
			<forward name="account" path="/showAccount.do" redirect="true" />
			<forward name="error" path="/login.do" />
		</action>
		<action path="/forgotPassword"
				name="forgotPasswordForm"
				scope="request"
				validate="false"
				input="/forgotPassword.jsp"
				type="org.apache.struts.actions.ForwardAction" parameter="/forgotPassword.jsp" />
		<action path="/forgotPasswordSubmit"
				name="forgotPasswordForm"
				scope="request"
				validate="true"
				input="/forgotPassword.jsp"
				type="com.philihp.weblabora.action.ForgotPasswordSubmit"
				>
			<forward name="input" path="/forgotPassword.jsp" />
		</action>
		<action path="/resetPassword"
				name="resetPasswordForm"
				scope="session"
				validate="false"
				type="com.philihp.weblabora.action.ResetPassword"
				>
			<forward name="success" path="/resetPassword.jsp" />
		</action>
		<action path="/resetPasswordSubmit"
				name="resetPasswordForm"
				scope="session"
				validate="true"
				input="/resetPassword.jsp"
				type="com.philihp.weblabora.action.ResetPasswordSubmit">
			<forward name="failure" path="/resetPassword.do" />
			<forward name="success" path="/login.do" redirect="true" />
		</action>
		<action path="/registerValidate"
				name="loginForm"
				scope="session"
				type="com.philihp.weblabora.action.RegisterValidate"
				validate="false"
				>
			<forward name="login" path="/login.do" />
		</action>
		<action path="/showAccount"
				name="accountForm"
				scope="request"
				validate="false"
				type="com.philihp.weblabora.action.ShowAccount">
			<forward name="view" path="/showAccount.jsp" />
		</action>
		<action path="/editAccountUnlinkFacebook"
				name="nullForm"
				scope="request"
				type="com.philihp.weblabora.action.EditAccountUnlinkFacebook">
			<forward name="success" path="/showAccount.do" redirect="true" />
		</action>
		<action path="/editAccountEmail"
				name="accountForm"
				scope="request"
				validate="true"
				input="/showAccount.jsp"
				type="com.philihp.weblabora.action.EditAccountEmail">
			<forward name="success" path="/showAccount.do" redirect="true" />
			<forward name="failure" path="/showAccount.jsp" />
		</action>
		<action path="/editAccountUsername"
				name="accountForm"
				scope="request"
				validate="true"
				input="/showAccount.jsp"
				type="com.philihp.weblabora.action.EditAccountUsername">
			<forward name="success" path="/showAccount.do" redirect="true" />
			<forward name="failure" path="/showAccount.jsp" />
		</action>
		<action path="/editAccountPassword"
				name="resetAccountPasswordForm"
				scope="request"
				validate="true"
				input="/showAccount.do"
				type="com.philihp.weblabora.action.EditAccountPassword">
			<forward name="success" path="/showAccount.do" redirect="true" />
			<forward name="failure" path="/showAccount.do" />
		</action>

		<action path="/showGame" name="gameForm" validate="true" input="/showLobby.do" scope="request" type="com.philihp.weblabora.action.ShowGame">
			<forward name="game-state" path="/showGameState.do" />
			<forward name="no-game" path="/selectGame.do" />
		</action>
		<action path="/showGameState" name="gameForm" scope="request" type="com.philihp.weblabora.action.ShowGameState">
			<forward name="view" path="/showBoard.jsp" />
		</action>
		<action path="/selectGame" name="nullForm" type="com.philihp.weblabora.action.SelectGame">
			<forward name="show-board" path="/showGame.do" redirect="true" />
			<forward name="no-games" path="/showGamePicker.do" redirect="true" />
		</action>
		<action path="/showGames" type="com.philihp.weblabora.action.ShowGames">
			<forward name="view" path="/showGames.jsp" />
		</action>
		<action path="/showLobby" type="com.philihp.weblabora.action.ShowLobby">
			<forward name="view" path="/showLobby.jsp" />
		</action>
		<action path="/createGame" name="createGameForm" type="com.philihp.weblabora.action.CreateGame" />
		<action path="/createGameForm" name="createGameForm" type="org.apache.struts.actions.ForwardAction" parameter="/createGameForm.jsp" />
		<action path="/joinGame" name="joinGameForm" type="com.philihp.weblabora.action.JoinGame" />
		<action path="/leaveGame" name="gameForm" scope="request" type="com.philihp.weblabora.action.LeaveGame" />
		<action path="/makeMove" name="moveForm" type="com.philihp.weblabora.action.MakeMove">
			<forward name="badMove" path="/badMove.jsp" />
			<forward name="save" path="/saveMove.do" />
		</action>
		
		<action path="/undoMove" name="gameForm" scope="request" type="com.philihp.weblabora.action.UndoMove">
			<forward name="undone" path="/showGame.do" redirect="true" />
		</action>
		
		<action path="/saveMove" name="moveForm" type="com.philihp.weblabora.action.SaveMove" />

		<action path="/normalizeGame" name="nullForm" type="com.philihp.weblabora.action.NormalizeGame" />


		<action path="/showChat" name="createChatForm" type="com.philihp.weblabora.action.ShowChat">
			<forward name="view" path="/showChat.jsp" />
			<forward name="no-game" path="/offline.do" />
		</action>
		<action path="/createChat" name="createChatForm" type="com.philihp.weblabora.action.CreateChat">
			<forward name="show-chat" redirect="true" path="/showChat.do" />
		</action>
	</action-mappings>

	<message-resources parameter="MessageResources" />
	
    <plug-in className="org.apache.struts.validator.ValidatorPlugIn">
        <set-property property="pathnames"
                      value="/org/apache/struts/validator/validator-rules.xml,
                             /WEB-INF/validation.xml" />
    </plug-in>
    
</struts-config>