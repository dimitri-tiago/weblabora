<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE form-validation PUBLIC
         "-//Apache Software Foundation//DTD Commons Validator Rules Configuration 1.3.0//EN"
         "http://jakarta.apache.org/commons/dtds/validator_1_3_0.dtd">

<form-validation>

	<global>
		<!-- Custom Validator -->
		<validator name="twofields" 
                   classname="com.philihp.weblabora.util.FieldMatchingValidator" 
                   method="validateTwoFields" 
                   methodParams="java.lang.Object,
                       org.apache.commons.validator.ValidatorAction,
                       org.apache.commons.validator.Field,
                       org.apache.struts.action.ActionMessages,
                       javax.servlet.http.HttpServletRequest" 
                   msg="errors.twofields" />
	</global>

	<formset>
	
		<form name="loginForm">
			<field property="username" depends="required,minlength">
				<arg key="prompt.username" />
				<arg name="minlength" key="${var:minlength}" resource="false"  position="1"/>
				<var>
					<var-name>minlength</var-name>
					<var-value>5</var-value>
				</var>
			</field>
			<field property="password" depends="required,minlength">
				<arg key="prompt.password" />
				<arg name="minlength" key="${var:minlength}" resource="false"  position="1"/>
				<var>
					<var-name>minlength</var-name>
					<var-value>5</var-value>
				</var>
			</field>
		</form>
		
		<form name="registerForm">
			<field property="username" depends="required,minlength">
				<arg key="prompt.username" />
				<arg name="minlength" key="${var:minlength}" resource="false"  position="1"/>
				<var>
					<var-name>minlength</var-name>
					<var-value>5</var-value>
				</var>
			</field>
			<field property="password" depends="required,minlength">
				<arg key="prompt.password" />
				<arg name="minlength" key="${var:minlength}" resource="false"  position="1"/>
				<var>
					<var-name>minlength</var-name>
					<var-value>5</var-value>
				</var>
			</field>
			<field property="confirmPassword" depends="required,twofields">
				<arg key="prompt.confirmPassword" />
				<arg name="twofields" key="prompt.confirmPassword" position="1"/>
				<var>
					<var-name>secondProperty</var-name>
					<var-value>password</var-value>
				</var>
			</field>
			<field property="email" depends="required,email">
				<arg key="prompt.email" />
			</field>
			<field property="confirmEmail" depends="required,twofields">
				<arg key="prompt.confirmEmail" />
				<arg name="twofields" key="prompt.confirmEmail" position="1"/>
				<var>
					<var-name>secondProperty</var-name>
					<var-value>email</var-value>
				</var>
			</field>
		</form>
		
		<form name="forgotPasswordForm">
			<field property="username" depends="required,minlength">
				<arg key="prompt.username" />
				<arg name="minlength" key="${var:minlength}" resource="false"  position="1"/>
				<var>
					<var-name>minlength</var-name>
					<var-value>5</var-value>
				</var>
			</field>
			<field property="email" depends="required,email">
				<arg key="prompt.email" />
			</field>
		</form>
		
		<form name="resetPasswordForm">
			<field property="validator" depends="required">
				<arg key="prompt.validator" />
			</field>
			<field property="password" depends="required,minlength">
				<arg key="prompt.password" />
				<arg name="minlength" key="${var:minlength}" resource="false"  position="1"/>
				<var>
					<var-name>minlength</var-name>
					<var-value>5</var-value>
				</var>
			</field>
			<field property="confirmPassword" depends="required,twofields">
				<arg key="prompt.confirmPassword" />
				<arg name="twofields" key="prompt.confirmPassword" position="1"/>
				<var>
					<var-name>secondProperty</var-name>
					<var-value>password</var-value>
				</var>
			</field>
		</form>
		
		<form name="resetAccountPasswordForm">
			<field property="currentPassword" depends="required">
				<arg key="prompt.currentPassword" />
			</field>
			<field property="newPassword" depends="required,minlength">
				<arg key="prompt.newPassword" />
				<arg name="minlength" key="${var:minlength}" resource="false"  position="1"/>
				<var>
					<var-name>minlength</var-name>
					<var-value>5</var-value>
				</var>
			</field>
			<field property="confirmPassword" depends="required,twofields">
				<arg key="prompt.confirmPassword" />
				<arg name="twofields" key="prompt.confirmPassword" position="1"/>
				<var>
					<var-name>secondProperty</var-name>
					<var-value>newPassword</var-value>
				</var>
			</field>
		</form>
		
		<form name="accountForm">
			<field property="email" depends="required,email">
				<arg key="prompt.email" />
			</field>
		</form>
		
	</formset>
</form-validation>